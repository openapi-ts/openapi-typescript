---
title: infiniteQueryOptions
---

# {{ $frontmatter.title }}

The `infiniteQueryOptions` method allows you to construct type-safe [Infinite Query Options](https://tanstack.com/query/latest/docs/framework/react/guides/infinite-queries).

`infiniteQueryOptions` can be used together with `@tanstack/react-query` APIs that take infinite query options, such as
[useInfiniteQuery](https://tanstack.com/query/latest/docs/framework/react/reference/useInfiniteQuery),
[usePrefetchInfiniteQuery](https://tanstack.com/query/latest/docs/framework/react/reference/usePrefetchInfiniteQuery),
[QueryClient.fetchInfiniteQuery](https://tanstack.com/query/latest/docs/reference/QueryClient#queryclientfetchinfinitequery)
among many others.

If you would like to use an infinite query API that is not explicitly supported by `openapi-react-query`, this is the way to go.

## Examples

[useInfiniteQuery example](use-infinite-query#example) rewritten using `infiniteQueryOptions`.

::: code-group

```tsx [src/app.tsx]
import { useInfiniteQuery } from '@tanstack/react-query';
import { $api } from './api';

const PostList = () => {
    const { data, fetchNextPage, hasNextPage, isFetching } = useInfiniteQuery(
        $api.infiniteQueryOptions(
            'get',
            '/posts',
            {
                params: {
                    query: {
                        limit: 10,
                    },
                },
            },
            {
                getNextPageParam: lastPage => lastPage.nextPage,
                initialPageParam: 0,
            }
        )
    );

    return (
        <div>
            {data?.pages.map((page, i) => (
                <div key={i}>
                    {page.items.map(post => (
                        <div key={post.id}>{post.title}</div>
                    ))}
                </div>
            ))}
            {hasNextPage && (
                <button onClick={() => fetchNextPage()} disabled={isFetching}>
                    {isFetching ? 'Loading...' : 'Load More'}
                </button>
            )}
        </div>
    );
};
```

```ts [src/api.ts]
import createFetchClient from 'openapi-fetch';
import createClient from 'openapi-react-query';
import type { paths } from './my-openapi-3-schema'; // generated by openapi-typescript

const fetchClient = createFetchClient<paths>({
    baseUrl: 'https://myapi.dev/v1/',
});
export const $api = createClient(fetchClient);
```

:::

::: info Good to Know

[useInfiniteQuery](use-infinite-query) uses `infiniteQueryOptions` under the hood.

:::

Usage with `usePrefetchInfiniteQuery`.

::: code-group

```tsx [src/post-list.tsx]
import { usePrefetchInfiniteQuery } from '@tanstack/react-query';
import { $api } from './api';

export const PostList = () => {
    // Prefetch infinite query
    usePrefetchInfiniteQuery(
        $api.infiniteQueryOptions(
            'get',
            '/posts',
            {
                params: {
                    query: {
                        limit: 10,
                    },
                },
            },
            {
                getNextPageParam: lastPage => lastPage.nextPage,
                initialPageParam: 0,
                pages: 3, // Prefetch first 3 pages
            }
        )
    );

    // ... rest of the component
};
```

```ts [src/api.ts]
import createFetchClient from 'openapi-fetch';
import createClient from 'openapi-react-query';
import type { paths } from './my-openapi-3-schema'; // generated by openapi-typescript

const fetchClient = createFetchClient<paths>({
    baseUrl: 'https://myapi.dev/v1/',
});
export const $api = createClient(fetchClient);
```

:::

## Api

```tsx
const infiniteQueryOptions = $api.infiniteQueryOptions(method, path, options, infiniteQueryOptions);
```

**Arguments**

- `method` **(required)**
    - The HTTP method to use for the request.
    - The method is used as key. See [Query Keys](https://tanstack.com/query/latest/docs/framework/react/guides/query-keys) for more information.
- `path` **(required)**
    - The pathname to use for the request.
    - Must be an available path for the given method in your schema.
    - The pathname is used as key. See [Query Keys](https://tanstack.com/query/latest/docs/framework/react/guides/query-keys) for more information.
- `options`
    - The fetch options to use for the request.
    - Only required if the OpenApi schema requires parameters.
    - The options `params` are used as key. See [Query Keys](https://tanstack.com/query/latest/docs/framework/react/guides/query-keys) for more information.
- `infiniteQueryOptions` **(required)**
    - `pageParamName` The query param name used for pagination, `"cursor"` by default.
    - `initialPageParam` **(required)**: The initial page param for the first page.
    - `getNextPageParam`: Function to calculate the next page param.
    - `getPreviousPageParam`: Function to calculate the previous page param.
    - Additional infinite query options can be passed through.

**Returns**

- [Infinite Query Options](https://tanstack.com/query/latest/docs/framework/react/guides/infinite-queries)
    - Fully typed thus `data` and `error` will be correctly deduced.
    - `queryKey` is `[method, path, params]`.
    - `queryFn` is set to a fetcher function that handles pagination.
