// important: MUST use require()!
const { fileURLToPath } = require("node:url");
const { astToString, default: openapiTS } = require("../dist/index.cjs");

const TIMEOUT = 10_000;

describe("CJS bundle", () => {
  test(
    "basic",
    async () => {
      const contents = astToString(await openapiTS(new URL("../examples/stripe-api.yaml", import.meta.url)));

      const output = `/**
 * This file was auto-generated by openapi-typescript.
 * Do not make direct changes to the file.
 */

${contents}`;

      await expect(output).toMatchFileSnapshot(fileURLToPath(new URL("../examples/stripe-api.ts", import.meta.url)));
    },
    TIMEOUT,
  );
});
